SPARQL
PREFIX rr: <http://www.w3.org/ns/r2rml#> 
PREFIX rml: <http://semweb.mmlab.be/ns/rml#> 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
PREFIX ql: <http://semweb.mmlab.be/ns/ql#> 
PREFIX map: <http://mapping.example.com/> 
PREFIX ma: <http://www.w3.org/ns/ma-ont#> 
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
PREFIX sd: <http://www.w3.org/ns/sparql-service-description#> 
PREFIX dc: <http://purl.org/dc/elements/1.1/> 
PREFIX foaf: <http://xmlns.com/foaf/0.1/> 
PREFIX rev: <http://purl.org/stuff/rev#> 
PREFIX v: <http://rdf.data-vocabulary.org/#> 
PREFIX schema: <http://schema.org/> 
PREFIX gtfs: <http://vocab.gtfs.org/terms#> 
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> 
PREFIX dct: <http://purl.org/dc/terms/> 


SELECT ?routeNumberGSPIM ?tripNameGSPIM ?stopNameGSPdl ?timeGSPdl ?stopNameIMECdl ?timeIMECdl
WHERE {
    BIND("2023-05-19T07:30:00"^^xsd:dateTime as ?startTime)
    BIND("2023-05-19T09:20:00"^^xsd:dateTime as ?endTime)
    #details stop GSP delijn
    ?stopGSPdl #a gtfs:Stop ;
        foaf:name ?stopNameGSPdl ;
        gtfs:code 204917 .       #station gent sp

    #details stop IMEC delijn
    ?stopIMECdl #a gtfs:Stop ;
        foaf:name ?stopNameIMECdl ;
        gtfs:code 200659 .        #zwijnaarde technologiepark

    #details trip GSP IMEC delijn
    ?tripGSPIMEC #a gtfs:Trip ;
        gtfs:headsign ?tripNameGSPIM ;
        gtfs:route ?routeGSPIM .
    OPTIONAL { ?tripGSPIMEC rdfs:label ?cancelGSPIMEC }.
    FILTER(!BOUND(?cancelGSPIMEC))

    ?routeGSPIM #a gtfs:Route ;
        gtfs:shortName ?routeNumberGSPIM .

    ?stopTimeGSPdl #a gtfs:StopTime ;
            gtfs:stop ?stopGSPdl ;
            gtfs:trip ?tripGSPIMEC ;
            gtfs:departureTime ?departureTimeGSPdl .
    OPTIONAL { ?stopTimeGSPdl gtfs:comment ?delayGSPdl }.
    BIND(IF(BOUND(?delayGSPdl),(?departureTimeGSPdl + ?delayGSPdl), ?departureTimeGSPdl) as ?timeGSPdl)
    # BIND(IF(BOUND(?delayGSPdl), ?delayGSPdl, 0) as ?delayGSPdl)
    # BIND((?departureTimeGSPdl + ?delayGSPdl) as ?timeGSPdl)

    FILTER (?timeGSPdl >= ?startTime)

    ?stopTimeIMECdl #a gtfs:StopTime ;
            gtfs:stop ?stopIMECdl ;
            gtfs:trip ?tripGSPIMEC ;
            gtfs:departureTime ?departureTimeIMECdl .
    OPTIONAL { ?stopTimeIMECdl gtfs:comment ?delayIMECdl }.
    BIND(IF(BOUND(?delayIMECdl),(?departureTimeIMECdl + ?delayIMECdl), ?departureTimeIMECdl) as ?timeIMECdl)
    # BIND(IF(BOUND(?delayIMECdl), ?delayIMECdl, 0) as ?delayIMECdl)
    # BIND((?departureTimeIMECdl + ?delayIMECdl) as ?timeIMECdl)

    FILTER (?timeIMECdl >= ?timeGSPdl && ?timeIMECdl <= ?endTime)


} ORDER BY ?timeGSPdl;